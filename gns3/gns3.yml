---
- hosts: all
  tasks:
    - name: download gns3 installer
      get_url:
        url: https://raw.githubusercontent.com/GNS3/gns3-server/master/scripts/remote-install.sh
        dest: /tmp/gns3-remote-install.sh
        mode: '0744'
        
    
    - name: install gns3
      shell: ./gns3-remote-install.sh --with-openvpn --with-iou --with-i386-repository
      args:
        chdir: /tmp
      become: yes

    - name: reboot
      reboot:
      become: yes

    - name: change vpn address
      lineinfile:
        path: /root/client.ovpn
        regexp: '^remote'
        line: "remote 127.0.0.1 1194 udp"
      become: yes

    - name: copy vpn configuration
      fetch:
        src: /root/client.ovpn
        dest: ./
        flat: yes
      become: yes

      